## 准备工作

使用的系统是实验3中已经安装的 Windows XP Professional With SP3 x32 (简体中文版)

[熊猫烧香样本[52pojie\].zip - 蓝奏云](https://wwz.lanzouo.com/iLB8oy7jj0j) 解压密码：52pojie

下载后将vir后缀改为exe即可

在虚拟机中设置共享文件夹，将所需文件放入

复制到桌面上，即可看到。

本次分析的病毒样本：

![image(7)](/course/softwareSecurtyHomework/image(7).png)

对虚拟机进行断网操作，并用VMWare拍摄快照，作为安全状态的存档。防火墙也要关闭。

![image(8)](/course/softwareSecurtyHomework/image(8).png)

## 运行病毒

运行病毒后，任务管理器无法打开，会快速闪退。

使用cmd查看进程，可以看到可疑的spo0lsv.exe程序，即为该病毒

![42c0024a293b50a259ce9c98bb13dd83](/course/softwareSecurtyHomework/42c0024a293b50a259ce9c98bb13dd83.png)

“熊猫烧香”不但能感染系统中exe，com，pif，src，html，asp等文件，他还能中止大量的反病毒软件进程并且会删除扩展名为gho的文件。该文件一般是系统备份工具GHOST的备份文件，使用户的系统备份文件丢失。

系统中所有.exe可执行文件全部被改成熊猫烧香的模样。

可以看见，C盘中毒后被感染的可执行文件都会变成“熊猫烧香”的图标

![image(9)](/course/softwareSecurtyHomework/image(9).png)

## 分析病毒行为

使用exeinfo查看病毒的信息，可以看出这个程序带了FSG 2.0的壳。

![image(10)](/course/softwareSecurtyHomework/image(10).png)

使用Ollydbg对病毒进行分析。

可以发现病毒自我复制到C:\Windows\System32\driver，并启动spo0lsv.exe

![image(11)](/course/softwareSecurtyHomework/image(11).png)

病毒会尝试关闭各种防火墙和杀毒软件

![image(12)](/course/softwareSecurtyHomework/image(12).png)

在每个目录下创建Desktop_.ini，保存被感染的时间

![image(13)](/course/softwareSecurtyHomework/image(13).png)

被感染的文件类型

![image(14)](/course/softwareSecurtyHomework/image(14).png)